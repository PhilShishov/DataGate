@model DataGate.Web.ViewModels.Documents.DocumentOverviewViewModel

<form id="form-document" method="post">
    <table class="table table-bordered table-hover" id="tbl-documents">
        <thead>
            <tr>
                <th class="text-secondary p-1">
                    File Description
                </th>
                <th class="text-secondary p-1">
                    Valid From:
                </th>
                <th class="text-secondary p-1">
                    Valid Until:
                </th>
                <th class="text-secondary p-1">
                    File Name
                </th>
                <th class="text-secondary p-1">
                    File Type
                </th>
                <th class="text-secondary p-1">
                </th>
                <th class="text-secondary p-1" hidden>
                    Document Id
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var document in Model.Documents)
            {
            <tr>
                <td class="p-1">
                    @document.Description
                </td>
                <td class="p-1">
                    @document.ValidFrom
                </td>
                <td class="p-1">
                    @document.ValidUntil
                </td>
                <td class="p-1">

                    <button class="btn-link-pharus text-left"
                            formtarget="_blank"
                            type="submit"
                            asp-route="files"
                            asp-route-name="@document.Name"
                            name="docValue"
                            value="@document.Name">
                        @Html.Encode(@System.IO.Path.GetFileNameWithoutExtension(document.Name))
                    </button>

                </td>
                <td class="p-1">
                    @document.Type
                </td>
                <td class="p-1">
                    <button type="button" class="btn btn-pharus btn-sm mr-1 btn-delete">
                        Delete
                    </button>
                </td>
                <td class="p-1" hidden>
                    @document.FileId
                </td>
            </tr>
            }
        </tbody>
    </table>
    <input type="hidden" name="AreaName" value="@Model.AreaName" />
</form>

<script>
    // ________________________________________________________
    //
    // Delete selected row from documents table by confirming
    $('.btn-delete').on('click', function () {
        const tokenDoc = $('#form-document input[name=__RequestVerificationToken]').val();
        const areaName = '@Model.AreaName';
        let con = confirm('Are you sure you want to delete this?');
        if (!con) {
            event.preventDefault();
        } else {
            const docValue = $(this).closest('tr').find('button:eq(0)').val();
            $.ajax({
                url: '/media/delete',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                headers: { 'X-CSRF-TOKEN': tokenDoc },
                data: { fileId: fileId, docValue: docValue, areaName: areaName },
                success: function (data) {
                    if (data.data == 'false') {
                        alert('Something wrong!');
                        return false;
                    }

                    $("#tbl-documents tr:contains('" + data.data + "')").remove();
                    $("#tbl-distinct-documents tr:contains('" + data.data + "')").remove();
                    alert('The file was successfully deleted.');
                }
            });
        }
        });
</script>